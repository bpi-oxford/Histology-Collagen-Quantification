The collagen analysis was implemented as a fully automated pipeline employing color deconvolution for stain channel separation and high-contrast region detection.

Prior to analysis, stain-specific color vectors were empirically determined for each batch of stained slides using QuPath software (Bankhead et al., 2017). Representative tissue regions exhibiting distinct Picrosirius Red (PSR) and Fast Green (FG) staining were selected, and color deconvolution vectors were estimated using QuPathâ€™s built-in algorithms to ensure consistent application across all samples within each batch.

Color deconvolution was performed using a custom Python-based pipeline implementing established algorithms for histochemical stain separation. Empirically determined stain vectors were used to mathematically decompose images into constituent stain channels. Whole slide images were optionally downsampled to optimize computational efficiency. Linear unmixing with the measured stain vectors was applied to generate individual PSR, FG, and residual channels.

Automated tissue detection was achieved using multi-level Otsu thresholding combined with morphological operations. Tissue regions were segmented from background, and morphological opening and closing were applied to remove artifacts and smooth boundaries. When available, manually defined regions of interest were incorporated to restrict analysis to specific tissue areas.

Collagen segmentation and quantification were performed on the PSR channel using automated thresholding. Large images were processed in a tiled fashion with overlapping regions to maintain continuity. Multi-class Otsu thresholding was applied, with the optimal threshold class typically corresponding to the lowest intensity regions, to identify collagen-positive areas. Quantitative metrics, including total collagen area, total tissue area, and collagen density, were calculated for each image or tile. Segmentation masks were generated to allow both visual validation and quality control.